{% extends 'games/base.html' %}

{% block title %}Кошик{% endblock %}

{% block content %}
  <div class="main-content">
    <section class="info-hero">
      <div class="info-hero__inner">
        <h1><i data-lucide="shopping-bag"></i> Кошик</h1>
        <p>Тут зберігаються всі ігри, які ти додав. Перевір кількість, очищай або переходь до оформлення замовлення.</p>
      </div>
    </section>

    {% if items %}
      <div class="cart-grid">
        {% for row in items %}
          <article class="cart-card">
            <a class="cart-card__cover" href="{% url 'game_detail' row.game.pk %}">
              {% if row.game.cover %}
                <img src="{{ row.game.cover.url }}" alt="{{ row.game.title }}" loading="lazy">
              {% else %}
                <span class="cart-card__placeholder" data-lucide="image"></span>
              {% endif %}
            </a>
            <div class="cart-card__info">
              <h3>{{ row.game.title }}</h3>
              <div class="cart-card__meta">
                <span class="inline-icon" data-lucide="package"></span>
                Кількість: {{ row.qty }} · {{ row.subtotal }} ₴
              </div>
            </div>
            <form action="{% url 'cart_remove' row.game.pk %}" method="post" class="cart-card__action">
              {% csrf_token %}
              <input type="hidden" name="next" value="{% url 'cart' %}">
              <button class="btn btn-secondary" type="submit">
                <span class="inline-icon" data-lucide="trash-2"></span>
                Видалити
              </button>
            </form>
          </article>
        {% endfor %}
      </div>

      <div class="cart-summary">
        <div class="cart-summary__total">
          <span class="inline-icon" data-lucide="wallet"></span>
          <strong>Разом:</strong> {{ total }} ₴
        </div>
        <div class="cart-summary__actions">
          <form action="{% url 'cart_clear' %}" method="post">
            {% csrf_token %}
            <input type="hidden" name="next" value="{% url 'cart' %}">
            <button class="btn btn-secondary" type="submit">
              <span class="inline-icon" data-lucide="trash"></span>
              Очистити
            </button>
          </form>
          <button class="btn" type="button">
            <span class="inline-icon" data-lucide="credit-card"></span>
            Оформити
          </button>
        </div>
      </div>
    {% else %}
      <div class="empty-state">
        <span class="empty-state__icon" data-lucide="shopping-bag"></span>
        <h3>Тут поки порожньо</h3>
        <p>Повернись до каталогу та додай ігри, які хочеш.</p>
        <a class="btn" href="{% url 'game_list' %}">
          <span class="inline-icon" data-lucide="library"></span>
          До каталогу
        </a>
      </div>
    {% endif %}
  </div>
{% endblock %}
